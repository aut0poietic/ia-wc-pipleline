!function(){"use strict";const t=document.createElement("template");t.innerHTML='<style>:host,ia-dijkstra{box-sizing:border-box;display:block;border:1px solid #ddd;overflow:hidden}.perspective,:host,ia-dijkstra{position:relative;width:100%;height:100%}.perspective{display:flex;perspective:100vw}.grid{position:relative;margin:auto;transform-origin:center;transform:rotateX(60deg) rotateY(0deg) rotate(-40deg);-webkit-backface-visibility:hidden;backface-visibility:hidden;transform-style:preserve-3d}.grid:before{content:"";top:0;left:0;width:100%;height:100%;background-color:transparent;z-index:0;box-shadow:0 0 30px #000;pointer-events:none}.cell,.grid:before{position:absolute;display:block}.cell{box-sizing:border-box;z-index:1;width:50px;height:50px;border:1px solid #222;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform-style:preserve-3d;background-size:cover}.cell:before{content:"";position:absolute;top:0;left:0;bottom:0;right:0;display:block}.cell[cost="1"]{background-image:url(dirt.jpg)}.cell[cost="2"]{background-image:url(forrest.jpg)}.cell.moveable:hover:before{background-color:rgba(113,128,255,.7)}.cell.moveable:before{background-color:rgba(113,128,255,.4)}.cell.character:before{background-color:rgba(14,140,17,.3)}#character{position:absolute;z-index:2;display:block;width:50px;height:50px;transform-origin:center;transform:rotateX(-60deg) rotateY(0deg) rotate(20deg) translate3d(1px,-17px,4px);transform-style:preserve-3d;fill:#0e8c11;stroke:rgba(0,0,0,.9);pointer-events:none;transition:all 1s linear}</style><div class="perspective">\n\t<div class="grid">\n\t\t<svg id="character" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 33 42"><path d="M33 36c0 4.1-8.6 6-16.5 6S0 40.1 0 36c0-3.2 4.8-4.7 8.7-5.4.9-.1 1.6.4 1.8 1.3s-.4 1.5-1.2 1.7C4.4 34.4 3 35.7 3 36c.2.8 4.7 3 13.5 3s13.3-2.2 13.5-3c0-.3-1.4-1.6-6.3-2.4-.8-.2-1.3-1-1.2-1.7s1-1.4 1.8-1.3c4 .7 8.7 2.2 8.7 5.4zm-9-21v9c0 .8-.7 1.5-1.5 1.5H21v9c0 .8-.7 1.5-1.5 1.5h-6c-.8 0-1.5-.7-1.5-1.5v-9h-1.5c-.8 0-1.5-.7-1.5-1.5v-9a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3zm-2.3-9a5.2 5.2 0 1 1-10.4 0 5.2 5.2 0 0 1 10.4 0z"/></svg>\n\t</div>\n</div>';customElements.define("ia-dijkstra",class extends HTMLElement{static get observedAttributes(){return["size","character-x","character-y","movement","zoom"]}get movement(){return parseInt(this.getAttribute("movement"),10)}get characterX(){return parseInt(this.getAttribute("character-x"),10)}get characterY(){return parseInt(this.getAttribute("character-y"),10)}get size(){return parseInt(this.getAttribute("size"))}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(t.content.cloneNode(!0)),this._grid=this.shadowRoot.querySelector(".grid"),this._character=this.shadowRoot.getElementById("character"),this._cells=[],this._showing=!1}connectedCallback(){this.initGrid(this.size),this._character.style.left=50*this.characterX+"px",this._character.style.top=50*this.characterY+"px",this._grid.addEventListener("click",this.grid_onClick.bind(this)),this.resetGrid()}attributeChangedCallback(t,e,r){e!==r&&("size"===t&&this.resetGrid(),"zoom"===t&&(this.shadowRoot.querySelector(".perspective").style.transform=`scale(${r})`))}grid_onClick(t){this._showing?t.target.classList.contains("moveable")&&(this.setAttribute("character-x",t.target.getAttribute("x")),this.setAttribute("character-y",t.target.getAttribute("y")),this._character.style.left=50*this.characterX+"px",this._character.style.top=50*this.characterY+"px",this.resetGrid(),this._showing=!1):this.characterX==parseInt(t.target.getAttribute("x"))&&this.characterY==parseInt(t.target.getAttribute("y"))&&(this._showing=!0,this.showGridMovement(this.getMovementArea()))}resetGrid(){var t=this.shadowRoot.querySelector(".character");t&&t.classList.remove("character");var e=this.shadowRoot.querySelectorAll(".moveable");e&&e.forEach(t=>t.classList.remove("moveable")),this._cells[this.characterX]&&this._cells[this.characterX][this.characterY]&&this._cells[this.characterX][this.characterY].el.classList.add("character")}showGridMovement(t){t.forEach(t=>{t.el.classList.add("moveable")})}initGrid(t){let e=50*t;this._grid.style.width=e+"px",this._grid.style.height=e+"px";for(let e=0;e<t;e++){this._cells[e]||(this._cells[e]=[]);for(let r=0;r<t;r++)this._cells[e][r]=this.createCell(e,r),this._grid.appendChild(this._cells[e][r].el)}}createCell(t,e){let r=document.createElement("div");r.classList.add("cell"),r.style.left=50*t+"px",r.style.top=50*e+"px",r.setAttribute("x",t),r.setAttribute("y",e);let s=Math.floor(2*Math.random())+1;return r.setAttribute("cost",s),{el:r,x:t,y:e,cost:s,value:-1}}getAdjacent(t){let e=[];return t.x+1<this.size&&e.push(this._cells[t.x+1][t.y]),t.y+1<this.size&&e.push(this._cells[t.x][t.y+1]),t.x-1>=0&&e.push(this._cells[t.x-1][t.y]),t.y-1>=0&&e.push(this._cells[t.x][t.y-1]),e}resetGridValues(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)this._cells[t][e].value=-1;this._cells[this.characterX][this.characterY].value=0}getMovementArea(){this.resetGridValues();let t=[],e=0,r=[this._cells[this.characterX][this.characterY]];for(;r.length>0;){let s=r.pop(),i=this.getAdjacent(s);for(let a=0;a<i.length;a++){let c=i[a];e=s.value+c.cost,(-1===c.value||e<c.value)&&(c.value=e,-1===r.indexOf(c)&&r.push(c)),e<=this.movement&&-1===t.indexOf(c)&&t.push(c)}}return t}})}();
