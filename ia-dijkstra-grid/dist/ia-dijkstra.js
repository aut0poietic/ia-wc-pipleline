!function(){"use strict";const e=document.createElement("template");e.innerHTML='<style>:host,ia-dijkstra{box-sizing:border-box;position:relative;display:block;width:100%;height:100%;border:1px solid #ddd;overflow:hidden}.perspective{display:flex;width:100%;height:100%;perspective:100vw}.grid{position:relative;margin:auto;transform-origin:center;transform:rotateX(60deg) rotateY(0deg) rotate(-40deg);transform-style:preserve-3d}.cell,.grid{-webkit-backface-visibility:hidden;backface-visibility:hidden}.cell{box-sizing:border-box;width:50px;height:50px;border:1px solid #555;transform-style:preserve-3d;background-size:cover}.cell,.cell:before{position:absolute;display:block}.cell:before{content:"";top:0;left:0;bottom:0;right:0}.cell[cost="1"]{background-image:url(dirt.jpg)}.cell[cost="2"]{background-image:url(forrest.jpg)}.cell.moveable:hover:before{background-color:rgba(113,128,255,.7)}.cell.moveable:before{background-color:rgba(113,128,255,.4)}.cell.character:before{background-color:rgba(14,140,17,.67)}</style><div class="perspective">\n\t<div class="grid"></div>\n</div>';customElements.define("ia-dijkstra",class extends HTMLElement{static get observedAttributes(){return["size","character-x","character-y","movement","zoom"]}get movement(){return parseInt(this.getAttribute("movement"),10)}get characterX(){return parseInt(this.getAttribute("character-x"),10)}get characterY(){return parseInt(this.getAttribute("character-y"),10)}get size(){return parseInt(this.getAttribute("size"))}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(e.content.cloneNode(!0)),this._grid=this.shadowRoot.querySelector(".grid"),this._cells=[],this._showing=!1}connectedCallback(){this.initGrid(this.size),this._grid.addEventListener("click",this.grid_onClick.bind(this)),this.resetGrid()}attributeChangedCallback(e,t,r){t!==r&&("size"===e&&this.resetGrid(),"zoom"===e&&(this.shadowRoot.querySelector(".perspective").style.transform=`scale(${r})`))}grid_onClick(e){this._showing?e.target.classList.contains("moveable")&&(this.setAttribute("character-x",e.target.getAttribute("x")),this.setAttribute("character-y",e.target.getAttribute("y")),this.resetGrid(),this._showing=!1):this.characterX==parseInt(e.target.getAttribute("x"))&&this.characterY==parseInt(e.target.getAttribute("y"))&&(this._showing=!0,this.showGridMovement(this.getMovementArea()))}resetGrid(){var e=this.shadowRoot.querySelector(".character");e&&e.classList.remove("character");var t=this.shadowRoot.querySelectorAll(".moveable");t&&t.forEach(e=>e.classList.remove("moveable")),this._cells[this.characterX]&&this._cells[this.characterX][this.characterY]&&this._cells[this.characterX][this.characterY].el.classList.add("character")}showGridMovement(e){e.forEach(e=>{e.el.classList.add("moveable")})}initGrid(e){let t=50*e;this._grid.style.width=t+"px",this._grid.style.height=t+"px";for(let t=0;t<e;t++){this._cells[t]||(this._cells[t]=[]);for(let r=0;r<e;r++)this._cells[t][r]=this.createCell(t,r),this._grid.appendChild(this._cells[t][r].el)}}createCell(e,t){let r=document.createElement("div");r.classList.add("cell"),r.style.left=50*e+"px",r.style.top=50*t+"px",r.setAttribute("x",e),r.setAttribute("y",t);let s=Math.floor(2*Math.random())+1;return r.setAttribute("cost",s),{el:r,x:e,y:t,cost:s,value:-1}}getAdjacent(e){let t=[];return e.x+1<this.size&&t.push(this._cells[e.x+1][e.y]),e.y+1<this.size&&t.push(this._cells[e.x][e.y+1]),e.x-1>=0&&t.push(this._cells[e.x-1][e.y]),e.y-1>=0&&t.push(this._cells[e.x][e.y-1]),t}resetGridValues(){for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++)this._cells[e][t].value=-1;this._cells[this.characterX][this.characterY].value=0}getMovementArea(){this.resetGridValues();let e=[],t=0,r=[this._cells[this.characterX][this.characterY]];for(;r.length>0;){let s=r.pop(),i=this.getAdjacent(s);for(let a=0;a<i.length;a++){let l=i[a];t=s.value+l.cost,(-1===l.value||t<l.value)&&(l.value=t,-1===r.indexOf(l)&&r.push(l)),t<=this.movement&&-1===e.indexOf(l)&&e.push(l)}}return e}})}();
